#!/usr/bin/env bash

paths=(
	"$HOME/uni/semestre6/"
	"$HOME/uni/semestre7/"
	# "$HOME/projects/"
)

selected=$1

[[ -z "$selected" ]] && {
	selected=$(fd . ${paths[@]} --max-depth=2 --type=directory \
					  | sed "s|^$HOME/||" \
						| sk)

	[[ -z "$selected" ]] && {
		echo "no directory selected"
		exit 1
	}

	selected="$HOME/$selected"
}

echo $selected

session_name=$(basename $selected | tr . _)

if ! tmux has-session -t "$session_name"; then
	selected_path=$(echo $selected | rev | cut -c2- | rev)
	tmux new-session -ds "$session_name" -c "$selected_path"
	tmux select-window -t "$session_name:1"
fi

tmux switch-client -t "$session_name"
